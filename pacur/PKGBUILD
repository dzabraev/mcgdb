targets=(
#    "archlinux"
#    "centos"
#    "debian"
#    "fedora"
    "ubuntu"
)
pkgname="mcgdb"
pkgver="1.2"
pkgrel="1"
pkgdesc="midnight commander as gdb front end"
pkgdesclong=(
    "midnight commander as gdb front end"
)
maintainer="Maxim Dzabraev <dzabraew@gmail.com>"

arch="amd64"
license=("GPLv3")
section="utils"
priority="optional"
url="https://github.com/dzabraev/${pkgname}"
sources=(
    #"https://github.com/dzabraev/mcgdb/releases/download/${pkgver}/mcgdb-${pkgver}.tar.gz"
    "https://github.com/dzabraev/mcgdb/archive/master.tar.gz"
)
hashsums=(
    #"42abc661c8aec2a9e284a84482184772"
    "4d262a8b6444b0f146111d2ad8d54b6c"
)

depends:apt=(
  "libglib2.0-dev"
  "libslang2-dev"
  "libpython2.7-dev"
  "python"
)




build:apt() {
    cd ${srcdir}
    mkdir -p root

    apt-get -y install texinfo #packages that needed for build only
    apt-get -y install libglib2.0-dev libslang2-dev libpython2.7-dev python

    wget "https://ftp.gnu.org/gnu/gdb/gdb-7.12.1.tar.xz"
    tar xvJf "gdb-7.12.1.tar.xz"
    cd "gdb-7.12.1"
    mkdir obj
    cd obj
    ../configure --with-python=python2 --program-prefix=mcgdb_ --prefix=/usr/bin/mcgdb_aux
    make -j4
    cd ${srcdir}

    wget "http://www.digip.org/jansson/releases/jansson-2.10.tar.gz"
    tar xzvf "jansson-2.10.tar.gz"
    cd "jansson-2.10"
    mkdir -p obj
    cd obj
    ../configure --disable-shared --prefix=${srcdir}/root
    make -j4
    make install
    cd ${srcdir}

#    wget http://ftp.gnome.org/pub/gnome/sources/glib/2.52/glib-2.52.1.tar.xz
#    tar xvJf glib-2.52.1.tar.xz
#    cd glib-2.52.1
#    mkdir obj
#    cd obj
#    ../configure --disable-shared --prefix=${srcdir}/root
#    make -j4
#    make install
#    cd ${srcdir}

#    wget http://www.jedsoft.org/releases/slang/slang-2.3.1a.tar.bz2
#    tar xvjf slang-2.3.1a.tar.bz2
#    cd slang-2.3.1a
#    ./configure --disable-shared --prefix=${srcdir}/root
#    make -j4
#    make install
#    cd ${srcdir}

    #tar xzvf "mcgdb-${pkgver}.tar.gz"
    #cd "mcgdb-${pkgver}"
    tar xzvf "master.tar.gz"
    cd mcgdb-master
    mkdir obj
    cd obj
    PKG_CONFIG_PATH=${srcdir}/root/lib/pkgconfig ../configure --prefix=/usr GDB=/usr/bin/mcgdb_aux/bin/mcgdb_gdb
    make -j4
    cd ${srcdir}
}

package() {
    cd ${srcdir}/gdb-7.12.1/obj
    make install DESTDIR=${pkgdir}
    cd ${srcdir}/mcgdb-master/obj
    make install DESTDIR=${pkgdir}
}